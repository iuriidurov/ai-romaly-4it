# AI-Romaly: Музыкальный Агрегатор

Этот проект представляет собой полнофункциональный веб-сайт, разработанный как агрегатор AI-сгенерированной музыки. Платформа позволяет авторам загружать свои треки, а пользователям — слушать и скачивать их. Проект включает в себя систему аутентификации, разделение ролей (администратор и автор) и персональные кабинеты для авторов.

## Технологический стек

*   **Бэкенд:** Node.js, Express.js
*   **База данных:** MongoDB с использованием Mongoose
*   **Фронтенд:** HTML5, CSS3, ванильный JavaScript (ES6+)
*   **Аутентификация:** JSON Web Tokens (JWT)
*   **Загрузка файлов:** Multer

---

## Структура проекта и описание файлов

Ниже приведено подробное описание каждого файла и директории в проекте.

### Корневая директория (`/`)

*   **`server.js`**: Главный файл приложения. Он выполняет следующие задачи:
    *   Инициализирует сервер Express.
    *   Подключается к базе данных MongoDB.
    *   Настраивает middleware (CORS, `body-parser`).
    *   Определяет маршруты для API (`/api/users`, `/api/tracks`) и для страниц (`/`, `/cabinet`).
    *   Запускает сервер на прослушивание порта (по умолчанию 3000).
    *   **Ключевое решение:** При первом запуске автоматически создает пользователя-администратора (`iuriidurov`/`admin`), что упрощает первоначальную настройку.

*   **`index.html`**: Главная страница сайта, доступная всем пользователям. На ней отображается полный список треков от всех авторов, отсортированный по дате добавления.

*   **`author.html`**: Страница личного кабинета автора. Доступна только после входа в систему. Здесь автор может видеть список своих треков, удалять их, а также видеть список других авторов на платформе.

*   **`reset-password.html`**: Отдельная страница для установки нового пароля. Пользователь попадает на нее по уникальной ссылке, сгенерированной системой восстановления.

*   **`package.json`**: Стандартный файл для Node.js проектов. Содержит список зависимостей (`dependencies`) и скрипты для запуска (`start`).

*   **`README.md`** (этот файл): Документация по проекту.

### Директория `config/`

*   **`default.json`**: Файл конфигурации. Хранит важные переменные, такие как строка подключения к MongoDB (`mongoURI`) и секретный ключ для JWT (`jwtSecret`).
    *   **Ключевое решение:** Вынесение конфигурации в отдельный файл позволяет легко изменять настройки для разных окружений (например, разработка и продакшн), не трогая основной код.

### Директория `css/`

*   **`style.css`**: Единый файл стилей для всего приложения. Содержит стили для главной страницы, личного кабинета, модальных окон, плеера и других элементов интерфейса.

### Директория `js/`

*   **`main.js`**: Клиентский JavaScript для `index.html`. Отвечает за:
    *   Загрузку и отображение общего списка треков.
    *   Логику аудиоплеера (воспроизведение/пауза).
    *   Работу модального окна аутентификации (вход, регистрация и восстановление пароля).
    *   Переключение между формами входа, регистрации и восстановления.
    *   Обновление интерфейса в зависимости от того, вошел пользователь в систему или нет.

*   **`author.js`**: Клиентский JavaScript для `author.html`. Отвечает за:
    *   Проверку авторизации пользователя и перенаправление на главную, если он не вошел.
    *   Загрузку и отображение треков, принадлежащих только текущему автору.
    *   Реализацию пагинации (переключения страниц) для списка треков.
    *   Загрузку и отображение списка всех авторов на сайте.
    *   Логику удаления трека.

### Директория `models/`

*   **`User.js`**: Mongoose-модель для коллекции пользователей. Определяет схему данных для пользователя: `name`, `emailOrPhone`, `password` (хранится в хешированном виде), `role` (`admin` или `author`), а также поля для восстановления пароля: `resetPasswordToken` и `resetPasswordExpires`.

*   **`Track.js`**: Mongoose-модель для коллекции треков. Определяет схему данных для трека: `title`, `author` (ссылка на модель `User`), `collectionName` и `filePath` (путь к аудиофайлу).

### Директория `controllers/`

*   **`userController.js`**: Содержит основную логику для обработки запросов, связанных с пользователями. Функции: `register`, `login`, `getUsers`, `forgotPassword` (для запроса на сброс) и `resetPassword` (для установки нового пароля).

*   **`trackController.js`**: Содержит логику для обработки запросов, связанных с треками. Функции: `getTracks` (получить все треки), `uploadTrack`, `deleteTrack`, `getTracksByAuthor` (получить треки конкретного автора).
    *   **Ключевое решение:** Разделение логики на контроллеры (бизнес-логика) и роуты (определение путей) — это стандартная практика в Express, которая делает код более чистым и организованным.

### Директория `routes/`

*   **`users.js`**: Определяет API-маршруты для пользователей (например, `POST /api/users/register`, `POST /api/users/forgot-password`). Связывает эти маршруты с функциями из `userController.js`.

*   **`tracks.js`**: Определяет API-маршруты для треков (например, `GET /api/tracks`). Связывает их с функциями из `trackController.js`.

### Директория `middleware/`

*   **`auth.js`**: Middleware-функция для защиты маршрутов. Она проверяет наличие и валидность JWT в заголовках запроса. Если токен валиден, информация о пользователе добавляется в объект запроса (`req.user`), и доступ к защищенному маршруту разрешается.

### Директория `uploads/`

*   Эта директория создается автоматически и используется для хранения загруженных пользователями аудиофайлов. Она добавлена в `.gitignore`, чтобы файлы не попадали в систему контроля версий.
